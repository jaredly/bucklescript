
    
<!doctype html>
<meta charset=utf8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel=stylesheet href='../styles.css'>
<script defer src='../script.js'></script>
<title>Belt_HashMap</title>
<body>
<script>window.relativeToRoot=".."</script>
<script defer src="../block-script.js"></script>
<div id='error-message'>
  ⚠️ Oops! This page doesn't appear to define a <span>type</span> called <code>_</code>.
</div>

    <script>window.shouldCheckHashes=true</script>
    <div class='container'>
    
    <div class='sidebar-wrapper'>
    <div class='sidebar-expander'>Show navigation</div>
    <div class='sidebar'>
      <a href="../search.html" style="display: block; padding: 0 8px;">Search</a>
      <a href="../playground.html" style="display: block; padding: 0 8px;">Playground</a>
      <div class='docs-listing'><a href="../docson/index.html">docson</a>
<a href="../slides/Haskell_meetup.html">Haskell_meetup</a>
<a href="../slides/Buckle_meetup.html">Buckle_meetup</a>
<a href="../slides/preview/Slides/bb-reveal-example/overview.html">overview</a>
<a href="../slides/preview/CONTRIBUTING.html">CONTRIBUTING</a>
<a href="../slides/preview/reveal-js/css/theme/index.html">theme</a>
<a href="../slides/preview/reveal-js/REVEAL_JS.html">REVEAL_JS</a>
<a href="../slides/preview/reveal-js/plugin/markdown/example.html">example</a>
<a href="../index.html">docs</a>
<a href="../fonts/LICENSE.html">LICENSE</a></div>
      <div class='toc-header'>Page Contents</div>
      <div class='table-of-contents'>
      <a href="#module-Int" class='level-0 module'>Int</a>
<a href="#module-String" class='level-0 module'>String</a>
<a href="#type-t" class='level-0 type'>t</a>
<a href="#type-id" class='level-0 type'>id</a>
<a href="#value-make" class='level-0 value'>make</a>
<a href="#value-clear" class='level-0 value'>clear</a>
<a href="#value-isEmpty" class='level-0 value'>isEmpty</a>
<a href="#value-set" class='level-0 value'>set</a>
<a href="#value-copy" class='level-0 value'>copy</a>
<a href="#value-get" class='level-0 value'>get</a>
<a href="#value-has" class='level-0 value'>has</a>
<a href="#value-remove" class='level-0 value'>remove</a>
<a href="#value-forEachU" class='level-0 value'>forEachU</a>
<a href="#value-forEach" class='level-0 value'>forEach</a>
<a href="#value-reduceU" class='level-0 value'>reduceU</a>
<a href="#value-reduce" class='level-0 value'>reduce</a>
<a href="#value-keepMapInPlaceU" class='level-0 value'>keepMapInPlaceU</a>
<a href="#value-keepMapInPlace" class='level-0 value'>keepMapInPlace</a>
<a href="#value-size" class='level-0 value'>size</a>
<a href="#value-toArray" class='level-0 value'>toArray</a>
<a href="#value-keysToArray" class='level-0 value'>keysToArray</a>
<a href="#value-valuesToArray" class='level-0 value'>valuesToArray</a>
<a href="#value-fromArray" class='level-0 value'>fromArray</a>
<a href="#value-mergeMany" class='level-0 value'>mergeMany</a>
<a href="#value-getBucketHistogram" class='level-0 value'>getBucketHistogram</a>
<a href="#value-logStats" class='level-0 value'>logStats</a>
<a href="#value-ofArray" class='level-0 value'>ofArray</a>
      </div>
      <div class='project-title'>Package modules</div><div class='project-listing'><a href="Js.html">Js</a>
<a href="Marshal.html">Marshal</a>
<a href="ListLabels.html">ListLabels</a>
<a href="Buffer.html">Buffer</a>
<a href="MoreLabels.html">MoreLabels</a>
<a href="Set.html">Set</a>
<a href="Nativeint.html">Nativeint</a>
<a href="Complex.html">Complex</a>
<a href="Genlex.html">Genlex</a>
<a href="UnixLabels.html">UnixLabels</a>
<a href="Filename.html">Filename</a>
<a href="Printf.html">Printf</a>
<a href="Stack.html">Stack</a>
<a href="Sys.html">Sys</a>
<a href="CamlinternalFormatBasics.html">CamlinternalFormatBasics</a>
<a href="Obj.html">Obj</a>
<a href="Std_exit.html">Std_exit</a>
<a href="Random.html">Random</a>
<a href="Stream.html">Stream</a>
<a href="Callback.html">Callback</a>
<a href="Lazy.html">Lazy</a>
<a href="CamlinternalOO.html">CamlinternalOO</a>
<a href="Gc.html">Gc</a>
<a href="Array.html">Array</a>
<a href="Char.html">Char</a>
<a href="Lexing.html">Lexing</a>
<a href="Printexc.html">Printexc</a>
<a href="Int32.html">Int32</a>
<a href="CamlinternalLazy.html">CamlinternalLazy</a>
<a href="Pervasives.html">Pervasives</a>
<a href="List.html">List</a>
<a href="Bytes.html">Bytes</a>
<a href="Hashtbl.html">Hashtbl</a>
<a href="CamlinternalFormat.html">CamlinternalFormat</a>
<a href="Queue.html">Queue</a>
<a href="BytesLabels.html">BytesLabels</a>
<a href="Parsing.html">Parsing</a>
<a href="Oo.html">Oo</a>
<a href="CamlinternalMod.html">CamlinternalMod</a>
<a href="String.html">String</a>
<a href="ArrayLabels.html">ArrayLabels</a>
<a href="Int64.html">Int64</a>
<a href="Sort.html">Sort</a>
<a href="StringLabels.html">StringLabels</a>
<a href="Digest.html">Digest</a>
<a href="Bigarray.html">Bigarray</a>
<a href="Arg.html">Arg</a>
<a href="Map.html">Map</a>
<a href="StdLabels.html">StdLabels</a>
<a href="Weak.html">Weak</a>
<a href="Format.html">Format</a>
<a href="Scanf.html">Scanf</a>
<a href="Unix.html">Unix</a>
<a href="Belt_MutableQueue.html">Belt_MutableQueue</a>
<a href="Belt_MapDict.html">Belt_MapDict</a>
<a href="Belt_List.html">Belt_List</a>
<a href="Js_string.html">Js_string</a>
<a href="Js_date.html">Js_date</a>
<a href="Belt_MapString.html">Belt_MapString</a>
<a href="Js_math.html">Js_math</a>
<a href="Belt.html">Belt</a>
<a href="Js_null_undefined.html">Js_null_undefined</a>
<a href="Node_path.html">Node_path</a>
<a href="Belt_MutableMap.html">Belt_MutableMap</a>
<a href="Js_types.html">Js_types</a>
<a href="Js_boolean.html">Js_boolean</a>
<a href="Belt_Map.html">Belt_Map</a>
<a href="Belt_SetString.html">Belt_SetString</a>
<a href="Dom_storage.html">Dom_storage</a>
<a href="Js_console.html">Js_console</a>
<a href="Belt_MapInt.html">Belt_MapInt</a>
<a href="Js_json.html">Js_json</a>
<a href="Dom.html">Dom</a>
<a href="Belt_Option.html">Belt_Option</a>
<a href="Js_mapperRt.html">Js_mapperRt</a>
<a href="Js_list.html">Js_list</a>
<a href="Node_process.html">Node_process</a>
<a href="Belt_internalSetBuckets.html">Belt_internalSetBuckets</a>
<a href="Belt_MutableSetString.html">Belt_MutableSetString</a>
<a href="Belt_internalSetInt.html">Belt_internalSetInt</a>
<a href="Node_module.html">Node_module</a>
<a href="Belt_HashMapInt.html">Belt_HashMapInt</a>
<a href="Js_result.html">Js_result</a>
<a href="Belt_MutableMapInt.html">Belt_MutableMapInt</a>
<a href="Node_buffer.html">Node_buffer</a>
<a href="Belt_Array.html">Belt_Array</a>
<a href="Belt_SetInt.html">Belt_SetInt</a>
<a href="Belt_MutableMapString.html">Belt_MutableMapString</a>
<a href="Node.html">Node</a>
<a href="Belt_internalSetString.html">Belt_internalSetString</a>
<a href="Belt_MutableSetInt.html">Belt_MutableSetInt</a>
<a href="Belt_HashSet.html">Belt_HashSet</a>
<a href="Belt_Range.html">Belt_Range</a>
<a href="Belt_internalBucketsType.html">Belt_internalBucketsType</a>
<a href="Js_array.html">Js_array</a>
<a href="Belt_HashSetInt.html">Belt_HashSetInt</a>
<a href="Belt_SetDict.html">Belt_SetDict</a>
<a href="Belt_HashMap.html">Belt_HashMap</a>
<a href="Js_vector.html">Js_vector</a>
<a href="Js_cast.html">Js_cast</a>
<a href="Belt_MutableStack.html">Belt_MutableStack</a>
<a href="Js_promise.html">Js_promise</a>
<a href="Belt_SortArrayInt.html">Belt_SortArrayInt</a>
<a href="Belt_SortArray.html">Belt_SortArray</a>
<a href="Js_global.html">Js_global</a>
<a href="Js_obj.html">Js_obj</a>
<a href="Belt_SortArrayString.html">Belt_SortArrayString</a>
<a href="Belt_Set.html">Belt_Set</a>
<a href="Belt_Id.html">Belt_Id</a>
<a href="Node_fs.html">Node_fs</a>
<a href="Belt_internalBuckets.html">Belt_internalBuckets</a>
<a href="Belt_internalMapInt.html">Belt_internalMapInt</a>
<a href="Js_re.html">Js_re</a>
<a href="Belt_internalAVLset.html">Belt_internalAVLset</a>
<a href="Belt_MutableSet.html">Belt_MutableSet</a>
<a href="Belt_HashSetString.html">Belt_HashSetString</a>
<a href="Js_option.html">Js_option</a>
<a href="Js_dict.html">Js_dict</a>
<a href="Belt_internalAVLtree.html">Belt_internalAVLtree</a>
<a href="Belt_internalMapString.html">Belt_internalMapString</a>
<a href="Node_child_process.html">Node_child_process</a>
<a href="Belt_HashMapString.html">Belt_HashMapString</a></div>
    </div>
    </div>
  
    <div class='main'>
    <a href="https://github.com/bucklescript/bucklescript/blob/master/jscomp/others/belt_HashMap.ml" class="edit-link">Edit</a>
    <p>A <strong>mutable</strong> Hash map which allows customized hash behavior.</p>
<p>All data are parameterized by not its only type but also a unique identity in the time of initialization, so that two <em>HashMaps of ints</em> initialized with different <em>hash</em> functions will have different type.</p>
<p>For example:</p>
<div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='54' id='block-54'><code>type t = int 
module I0 =
  (val Belt.Id.hashableU
      ~hash:(fun[\@bs] (a : t)  -&gt; a &amp; 0xff_ff)
      ~eq:(fun[\@bs] a b -&gt; a = b)
  )
let s0 : (_, string,_) t = make ~hintSize:40 ~id:(module I0)
module I1 =
  (val Belt.Id.hashableU
      ~hash:(fun[\@bs] (a : t)  -&gt; a &amp; 0xff)
      ~eq:(fun[\@bs] a b -&gt; a = b)
  )
let s1 : (_, string,_) t  = make ~hintSize:40 ~id:(module I1)</code></pre>
  
  <script type='docre-source' data-block-id="54">#open Belt_HashMap
type t = int 
module I0 =
  (val Belt.Id.hashableU
      ~hash:(fun[\@bs] (a : t)  -> a & 0xff_ff)
      ~eq:(fun[\@bs] a b -> a = b)
  )
let s0 : (_, string,_) t = make ~hintSize:40 ~id:(module I0)
module I1 =
  (val Belt.Id.hashableU
      ~hash:(fun[\@bs] (a : t)  -> a & 0xff)
      ~eq:(fun[\@bs] a b -> a = b)
  )
let s1 : (_, string,_) t  = make ~hintSize:40 ~id:(module I1)</script>
  <div class='parse-error'>Parse Error:
File &quot;&quot;, line 5, characters 17-18:
Error: Illegal character (\\)</div>
</div><div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='54-alt' id='block-54-alt'><code>Unable to refmt code with a syntax error</code></pre>
  
  
  
</div><p>The invariant must be held: for two elements who are <em>equal</em>, their hashed value should be the same</p>
<p>Here the compiler would infer <code>s0</code> and <code>s1</code> having different type so that it would not mix.</p>
<div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='56' id='block-56'><code>val s0 :  (int, I0.identity) t
val s1 :  (int, I1.identity) t</code></pre>
  
  <script type='docre-source' data-block-id="56">#open Belt_HashSet
val s0 :  (int, I0.identity) t
val s1 :  (int, I1.identity) t</script>
  <div class='parse-error'>Parse Error:
File &quot;&quot;, line 2, characters 0-3:
Error: Syntax error</div>
</div><div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='56-alt' id='block-56-alt'><code>Unable to refmt code with a syntax error</code></pre>
  
  
  
</div><p>We can add elements to the collection:</p>
<div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='52' id='block-52'><code>let <span class='pattern-constructor' data-type="unit">()</span> =
  add s1 0 &quot;3&quot;;
  add s1 1 &quot;3&quot;</code></pre>
  
  <script type='docre-source' data-block-id="52">#open Belt_HashMap
let () =
  add s1 0 "3";
  add s1 1 "3"</script>
  <div class='type-error'>Type Error:
File &quot;&quot;, line 3, characters 2-5:
Error: Unbound value add</div>
</div><div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='52-alt' id='block-52-alt'><code>open Belt_HashMap;

let <span class='pattern-constructor' data-type="unit">()</span> = {
  add(s1, 0, &quot;3&quot;);
  add(s1, 1, &quot;3&quot;);
};</code></pre>
  
  <script type='docre-source' data-block-id="52-alt">open Belt_HashMap;

let () = {
  add(s1, 0, "3");
  add(s1, 1, "3");
};</script>
  <div class='type-error'>Type Error:
File &quot;&quot;, line 4, characters 2-5:
Error: Unbound value add</div>
</div><p>Since this is an mutable data strucure, <code>s1</code> will contain two pairs.</p>
<p>other items defined</p><div class='doc-item'><h4 class='item module'>module <a href="#module-Int" id="module-Int">Int</a> : <a href="Belt_HashMapInt.html">Belt_HashMapInt</a></h4><div class='body module-body'><p>Specalized when key type is <code>int</code>, more efficient than the gerneic type</p>
</div></div>

<div class='doc-item'><h4 class='item module'>module <a href="#module-String" id="module-String">String</a> : <a href="Belt_HashMapString.html">Belt_HashMapString</a></h4><div class='body module-body'><p>Specalized when key type is <code>string</code>, more efficient than the gerneic type</p>
</div></div>

<div class='doc-item'><h4 class='item'>type <a href="#type-t" id="type-t">t</a>('key, 'value, 'id)</h4>

<div class='body '><p>The type of hash tables from type <code>&#39;key</code> to type <code>&#39;value</code>.</p>
</div></div>

<div class='doc-item'><h4 class='item'>type <a href="#type-id" id="type-id">id</a>('a, 'id) = <a href="Belt_Id.html#type-hashable" title="Belt_Id.hashable">hashable</a>('a, 'id)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-make" id="value-make">make</a>: (~hintSize: int, ~id: <a href="#type-id">id</a>('key, 'id)) => <a href="#type-t">t</a>(
  'key,
  'value,
  'id
)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-clear" id="value-clear">clear</a>: <a href="#type-t">t</a>('key, 'value, 'id) => unit</h4>

<div class='body '><p>Empty a hash table.</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-isEmpty" id="value-isEmpty">isEmpty</a>: <a href="#type-t">t</a>('a, 'a, 'a) => bool</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-set" id="value-set">set</a>: (<a href="#type-t">t</a>('key, 'value, 'id), 'key, 'value) => unit</h4>

<div class='body '><p><code>set tbl k v</code> if <code>k</code> does not exist, add the binding <code>k,v</code>, otherwise, update the old value with the new <code>v</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-copy" id="value-copy">copy</a>: <a href="#type-t">t</a>('key, 'value, 'id) => <a href="#type-t">t</a>('key, 'value, 'id)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-get" id="value-get">get</a>: (<a href="#type-t">t</a>('key, 'value, 'id), 'key) => option('value)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-has" id="value-has">has</a>: (<a href="#type-t">t</a>('key, 'value, 'id), 'key) => bool</h4>

<div class='body '><p><code>has tbl x</code> checks if <code>x</code> is bound in <code>tbl</code>.</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-remove" id="value-remove">remove</a>: (<a href="#type-t">t</a>('key, 'value, 'id), 'key) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-forEachU" id="value-forEachU">forEachU</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  <a href="Js.html#type-Internal.fn" title="Js.Internal.fn">fn</a>([ `Arity_2 of 'key1 * 'value1 ], unit)
) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-forEach" id="value-forEach">forEach</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  ('key, 'value) => unit
) => unit</h4>

<div class='body '><p><code>forEach tbl f</code> applies <code>f</code> to all bindings in table <code>tbl</code>. <code>f</code> receives the key as first argument, and the associated value as second argument. Each binding is presented exactly once to <code>f</code>.</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-reduceU" id="value-reduceU">reduceU</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  'c,
  <a href="Js.html#type-Internal.fn" title="Js.Internal.fn">fn</a>([ `Arity_3 of 'c3 * 'key0 * 'value0 ], 'c)
) => 'c</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-reduce" id="value-reduce">reduce</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  'c,
  ('c, 'key, 'value) => 'c
) => 'c</h4>

<div class='body '><p><code>reduce  tbl init f</code> computes <code>(f kN dN ... (f k1 d1 init)...)</code>, where <code>k1 ... kN</code> are the keys of all bindings in <code>tbl</code>, and <code>d1 ... dN</code> are the associated values. Each binding is presented exactly once to <code>f</code>.</p>
<p>The order in which the bindings are passed to <code>f</code> is unspecified. However, if the table contains several bindings for the same key, they are passed to <code>f</code> in reverse order of introduction, that is, the most recent binding is passed first.</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-keepMapInPlaceU" id="value-keepMapInPlaceU">keepMapInPlaceU</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  <a href="Js.html#type-Internal.fn" title="Js.Internal.fn">fn</a>([ `Arity_2 of 'key * 'value ], option('value))
) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-keepMapInPlace" id="value-keepMapInPlace">keepMapInPlace</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  ('key, 'value) => option('value)
) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-size" id="value-size">size</a>: <a href="#type-t">t</a>('a, 'a, 'a) => int</h4>

<div class='body '><p><code>size tbl</code> returns the number of bindings in <code>tbl</code>. It takes constant time.</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-toArray" id="value-toArray">toArray</a>: <a href="#type-t">t</a>('key, 'value, 'id) => array(('key, 'value))</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-keysToArray" id="value-keysToArray">keysToArray</a>: <a href="#type-t">t</a>('key, 'a, 'a) => array('key)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-valuesToArray" id="value-valuesToArray">valuesToArray</a>: <a href="#type-t">t</a>('a, 'value, 'a) => array('value)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-fromArray" id="value-fromArray">fromArray</a>: (
  array(('key, 'value)),
  ~id: <a href="#type-id">id</a>('key, 'id)
) => <a href="#type-t">t</a>('key, 'value, 'id)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-mergeMany" id="value-mergeMany">mergeMany</a>: (
  <a href="#type-t">t</a>('key, 'value, 'id),
  array(('key, 'value))
) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-getBucketHistogram" id="value-getBucketHistogram">getBucketHistogram</a>: <a href="#type-t">t</a>('a, 'a, 'a) => array(int)</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-logStats" id="value-logStats">logStats</a>: <a href="#type-t">t</a>('a, 'a, 'a) => unit</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-ofArray" id="value-ofArray">ofArray</a>: (
  array(('key, 'value)),
  ~id: <a href="#type-id">id</a>('key, 'id)
) => <a href="#type-t">t</a>('key, 'value, 'id)</h4>

<div class='body body-empty'></div></div>
    </div>
    <div class='right-blank'></div>
    </div>
  