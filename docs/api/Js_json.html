
    
<!doctype html>
<meta charset=utf8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel=stylesheet href='../styles.css'>
<script defer src='../script.js'></script>
<title>Js_json</title>
<body>
<script>window.relativeToRoot=".."</script>
<script defer src="../block-script.js"></script>
<div id='error-message'>
  ⚠️ Oops! This page doesn't appear to define a <span>type</span> called <code>_</code>.
</div>

    <script>window.shouldCheckHashes=true</script>
    <div class='container'>
    
    <div class='sidebar-wrapper'>
    <div class='sidebar-expander'>Show navigation</div>
    <div class='sidebar'>
      <a href="../search.html" style="display: block; padding: 0 8px;">Search</a>
      <a href="../playground.html" style="display: block; padding: 0 8px;">Playground</a>
      <div class='docs-listing'><a href="../docson/index.html">docson</a>
<a href="../fonts/LICENSE.html">LICENSE</a>
<a href="../index.html">docs</a>
<a href="../slides/Buckle_meetup.html">Buckle_meetup</a>
<a href="../slides/Haskell_meetup.html">Haskell_meetup</a>
<a href="../slides/preview/CONTRIBUTING.html">CONTRIBUTING</a>
<a href="../slides/preview/reveal-js/css/theme/index.html">theme</a>
<a href="../slides/preview/reveal-js/plugin/markdown/example.html">example</a>
<a href="../slides/preview/reveal-js/REVEAL_JS.html">REVEAL_JS</a>
<a href="../slides/preview/Slides/bb-reveal-example/overview.html">overview</a></div>
      <div class='toc-header'>Page Contents</div>
      <div class='table-of-contents'>
      <a href="#type-t" class='level-0 type'>t</a>
<a href="#type-kind" class='level-0 type'>kind</a>
<a href="#type-tagged_t" class='level-0 type'>tagged_t</a>
<a href="#value-classify" class='level-0 value'>classify</a>
<a href="#value-test" class='level-0 value'>test</a>
<a href="#value-decodeString" class='level-0 value'>decodeString</a>
<a href="#value-decodeNumber" class='level-0 value'>decodeNumber</a>
<a href="#value-decodeObject" class='level-0 value'>decodeObject</a>
<a href="#value-decodeArray" class='level-0 value'>decodeArray</a>
<a href="#value-decodeBoolean" class='level-0 value'>decodeBoolean</a>
<a href="#value-decodeNull" class='level-0 value'>decodeNull</a>
<a href="#value-null" class='level-0 value'>null</a>
<a href="#value-string" class='level-0 value'>string</a>
<a href="#value-number" class='level-0 value'>number</a>
<a href="#value-boolean" class='level-0 value'>boolean</a>
<a href="#value-object_" class='level-0 value'>object_</a>
<a href="#value-array" class='level-0 value'>array</a>
<a href="#value-stringArray" class='level-0 value'>stringArray</a>
<a href="#value-numberArray" class='level-0 value'>numberArray</a>
<a href="#value-booleanArray" class='level-0 value'>booleanArray</a>
<a href="#value-objectArray" class='level-0 value'>objectArray</a>
<a href="#value-parseExn" class='level-0 value'>parseExn</a>
<a href="#value-stringify" class='level-0 value'>stringify</a>
<a href="#value-stringifyAny" class='level-0 value'>stringifyAny</a>
      </div>
      <div class='project-title'>Package modules</div><div class='project-listing'><a href="Js.html">Js</a>
<a href="Arg.html">Arg</a>
<a href="Array.html">Array</a>
<a href="ArrayLabels.html">ArrayLabels</a>
<a href="Bigarray.html">Bigarray</a>
<a href="Buffer.html">Buffer</a>
<a href="Bytes.html">Bytes</a>
<a href="BytesLabels.html">BytesLabels</a>
<a href="Callback.html">Callback</a>
<a href="CamlinternalFormat.html">CamlinternalFormat</a>
<a href="CamlinternalFormatBasics.html">CamlinternalFormatBasics</a>
<a href="CamlinternalLazy.html">CamlinternalLazy</a>
<a href="CamlinternalMod.html">CamlinternalMod</a>
<a href="CamlinternalOO.html">CamlinternalOO</a>
<a href="Char.html">Char</a>
<a href="Complex.html">Complex</a>
<a href="Digest.html">Digest</a>
<a href="Filename.html">Filename</a>
<a href="Format.html">Format</a>
<a href="Gc.html">Gc</a>
<a href="Genlex.html">Genlex</a>
<a href="Hashtbl.html">Hashtbl</a>
<a href="Int32.html">Int32</a>
<a href="Int64.html">Int64</a>
<a href="Lazy.html">Lazy</a>
<a href="Lexing.html">Lexing</a>
<a href="List.html">List</a>
<a href="ListLabels.html">ListLabels</a>
<a href="Map.html">Map</a>
<a href="Marshal.html">Marshal</a>
<a href="MoreLabels.html">MoreLabels</a>
<a href="Nativeint.html">Nativeint</a>
<a href="Obj.html">Obj</a>
<a href="Oo.html">Oo</a>
<a href="Parsing.html">Parsing</a>
<a href="Pervasives.html">Pervasives</a>
<a href="Printexc.html">Printexc</a>
<a href="Printf.html">Printf</a>
<a href="Queue.html">Queue</a>
<a href="Random.html">Random</a>
<a href="Scanf.html">Scanf</a>
<a href="Set.html">Set</a>
<a href="Sort.html">Sort</a>
<a href="Stack.html">Stack</a>
<a href="Std_exit.html">Std_exit</a>
<a href="StdLabels.html">StdLabels</a>
<a href="Stream.html">Stream</a>
<a href="String.html">String</a>
<a href="StringLabels.html">StringLabels</a>
<a href="Sys.html">Sys</a>
<a href="Unix.html">Unix</a>
<a href="UnixLabels.html">UnixLabels</a>
<a href="Weak.html">Weak</a>
<a href="Belt.html">Belt</a>
<a href="Belt_Array.html">Belt_Array</a>
<a href="Belt_HashMap.html">Belt_HashMap</a>
<a href="Belt_HashMapInt.html">Belt_HashMapInt</a>
<a href="Belt_HashMapString.html">Belt_HashMapString</a>
<a href="Belt_HashSet.html">Belt_HashSet</a>
<a href="Belt_HashSetInt.html">Belt_HashSetInt</a>
<a href="Belt_HashSetString.html">Belt_HashSetString</a>
<a href="Belt_Id.html">Belt_Id</a>
<a href="Belt_internalAVLset.html">Belt_internalAVLset</a>
<a href="Belt_internalAVLtree.html">Belt_internalAVLtree</a>
<a href="Belt_internalBuckets.html">Belt_internalBuckets</a>
<a href="Belt_internalBucketsType.html">Belt_internalBucketsType</a>
<a href="Belt_internalMapInt.html">Belt_internalMapInt</a>
<a href="Belt_internalMapString.html">Belt_internalMapString</a>
<a href="Belt_internalSetBuckets.html">Belt_internalSetBuckets</a>
<a href="Belt_internalSetInt.html">Belt_internalSetInt</a>
<a href="Belt_internalSetString.html">Belt_internalSetString</a>
<a href="Belt_List.html">Belt_List</a>
<a href="Belt_Map.html">Belt_Map</a>
<a href="Belt_MapDict.html">Belt_MapDict</a>
<a href="Belt_MapInt.html">Belt_MapInt</a>
<a href="Belt_MapString.html">Belt_MapString</a>
<a href="Belt_MutableMap.html">Belt_MutableMap</a>
<a href="Belt_MutableMapInt.html">Belt_MutableMapInt</a>
<a href="Belt_MutableMapString.html">Belt_MutableMapString</a>
<a href="Belt_MutableQueue.html">Belt_MutableQueue</a>
<a href="Belt_MutableSet.html">Belt_MutableSet</a>
<a href="Belt_MutableSetInt.html">Belt_MutableSetInt</a>
<a href="Belt_MutableSetString.html">Belt_MutableSetString</a>
<a href="Belt_MutableStack.html">Belt_MutableStack</a>
<a href="Belt_Option.html">Belt_Option</a>
<a href="Belt_Range.html">Belt_Range</a>
<a href="Belt_Set.html">Belt_Set</a>
<a href="Belt_SetDict.html">Belt_SetDict</a>
<a href="Belt_SetInt.html">Belt_SetInt</a>
<a href="Belt_SetString.html">Belt_SetString</a>
<a href="Belt_SortArray.html">Belt_SortArray</a>
<a href="Belt_SortArrayInt.html">Belt_SortArrayInt</a>
<a href="Belt_SortArrayString.html">Belt_SortArrayString</a>
<a href="Dom.html">Dom</a>
<a href="Dom_storage.html">Dom_storage</a>
<a href="Js_array.html">Js_array</a>
<a href="Js_boolean.html">Js_boolean</a>
<a href="Js_cast.html">Js_cast</a>
<a href="Js_console.html">Js_console</a>
<a href="Js_date.html">Js_date</a>
<a href="Js_dict.html">Js_dict</a>
<a href="Js_global.html">Js_global</a>
<a href="Js_json.html">Js_json</a>
<a href="Js_list.html">Js_list</a>
<a href="Js_mapperRt.html">Js_mapperRt</a>
<a href="Js_math.html">Js_math</a>
<a href="Js_null_undefined.html">Js_null_undefined</a>
<a href="Js_obj.html">Js_obj</a>
<a href="Js_option.html">Js_option</a>
<a href="Js_promise.html">Js_promise</a>
<a href="Js_re.html">Js_re</a>
<a href="Js_result.html">Js_result</a>
<a href="Js_string.html">Js_string</a>
<a href="Js_types.html">Js_types</a>
<a href="Js_vector.html">Js_vector</a>
<a href="Node.html">Node</a>
<a href="Node_buffer.html">Node_buffer</a>
<a href="Node_child_process.html">Node_child_process</a>
<a href="Node_fs.html">Node_fs</a>
<a href="Node_module.html">Node_module</a>
<a href="Node_path.html">Node_path</a>
<a href="Node_process.html">Node_process</a></div>
    </div>
    </div>
  
    <div class='main'>
    <a href="https://github.com/bucklescript/bucklescript/blob/master/jscomp/others/js_json.ml" class="edit-link">Edit</a>
    <p>Efficient JSON encoding using JavaScript API</p>
<p>See: <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON'><p>MDN</p>
</a></p>
<p>other items defined</p><div class='doc-item'><h2 id="Types">Types</h2></div>

<div class='doc-item'><h4 class='item'>type <a href="#type-t" id="type-t">t</a></h4>

<div class='body '><p>The JSON data structure</p>
</div></div>

<div class='doc-item'><h4 class='item'>type <a href="#type-kind" id="type-kind">kind</a>('_) = 
  | String: <a href="#type-kind">kind</a>(<a href="Js_string.html">Js_string</a>.<a href="Js_string.html#type-t">t</a>)
  | Number: <a href="#type-kind">kind</a>(float)
  | Object: <a href="#type-kind">kind</a>(<a href="Js_dict.html">Js_dict</a>.<a href="Js_dict.html#type-t">t</a>(<a href="#type-t">t</a>))
  | Array: <a href="#type-kind">kind</a>(array(<a href="#type-t">t</a>))
  | Boolean: <a href="#type-kind">kind</a>(<a href="Js.html#type-boolean" title="Js.boolean">boolean</a>)
  | Null: <a href="#type-kind">kind</a>(<a href="Js_types.html#type-null_val" title="Js_types.null_val">null_val</a>)</h4>

<div class='body '><p>Underlying type of a JSON value</p>
</div></div>

<div class='doc-item'><h4 class='item'>type <a href="#type-tagged_t" id="type-tagged_t">tagged_t</a> = 
  | JSONFalse
  | JSONTrue
  | JSONNull
  | JSONString(string)
  | JSONNumber(float)
  | JSONObject(<a href="Js_dict.html">Js_dict</a>.<a href="Js_dict.html#type-t">t</a>(<a href="#type-t">t</a>))
  | JSONArray(array(<a href="#type-t">t</a>))</h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h2 id="Accessor">Accessor</h2></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-classify" id="value-classify">classify</a>: <a href="#type-t">t</a> => <a href="#type-tagged_t">tagged_t</a></h4>

<div class='body body-empty'></div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-test" id="value-test">test</a>: ('a, <a href="#type-kind">kind</a>('b)) => bool</h4>

<div class='body '><p><code>test v kind</code> returns true if <code>v</code> is of <code>kind</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeString" id="value-decodeString">decodeString</a>: <a href="#type-t">t</a> => option(<a href="Js_string.html">Js_string</a>.<a href="Js_string.html#type-t">t</a>)</h4>

<div class='body '><p><code>decodeString json</code> returns <code>Some s</code> if <code>json</code> is a string, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeNumber" id="value-decodeNumber">decodeNumber</a>: <a href="#type-t">t</a> => option(float)</h4>

<div class='body '><p><code>decodeNumber json</code> returns <code>Some n</code> if <code>json</code> is a number, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeObject" id="value-decodeObject">decodeObject</a>: <a href="#type-t">t</a> => option(<a href="Js_dict.html">Js_dict</a>.<a href="Js_dict.html#type-t">t</a>(<a href="#type-t">t</a>))</h4>

<div class='body '><p><code>decodeObject json</code> returns <code>Some o</code> if <code>json</code> is an object, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeArray" id="value-decodeArray">decodeArray</a>: <a href="#type-t">t</a> => option(array(<a href="#type-t">t</a>))</h4>

<div class='body '><p><code>decodeArray json</code> returns <code>Some a</code> if <code>json</code> is an array, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeBoolean" id="value-decodeBoolean">decodeBoolean</a>: <a href="#type-t">t</a> => option(<a href="Js.html#type-boolean" title="Js.boolean">boolean</a>)</h4>

<div class='body '><p><code>decodeBoolean json</code> returns <code>Some b</code> if <code>json</code> is a boolean, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-decodeNull" id="value-decodeNull">decodeNull</a>: <a href="#type-t">t</a> => option(Js_null.t('a))</h4>

<div class='body '><p><code>decodeNull json</code> returns <code>Some null</code> if <code>json</code> is a null, <code>None</code> otherwise</p>
</div></div>

<div class='doc-item'><h2 id="Construtors">Construtors</h2></div>

<div class='doc-item'><p>Those functions allows the construction of an arbitrary complex JSON values.</p>
</div>

<div class='doc-item'><h4 class='item'>let <a href="#value-null" id="value-null">null</a>: <a href="#type-t">t</a></h4>

<div class='body '><p><code>null</code> is the singleton null JSON value</p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-string" id="value-string">string</a>: string => <a href="#type-t">t</a></h4>

<div class='body '><p><code>string s</code> makes a JSON string of the <code>string</code> <code>s</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-number" id="value-number">number</a>: float => <a href="#type-t">t</a></h4>

<div class='body '><p><code>number n</code> makes a JSON number of the <code>float</code> <code>n</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-boolean" id="value-boolean">boolean</a>: <a href="Js.html#type-boolean" title="Js.boolean">boolean</a> => <a href="#type-t">t</a></h4>

<div class='body '><p><code>boolean b</code> makes a JSON boolean of the <code>Js.boolean</code> <code>b</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-object_" id="value-object_">object_</a>: <a href="Js_dict.html">Js_dict</a>.<a href="Js_dict.html#type-t">t</a>(<a href="#type-t">t</a>) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>object_ dict</code> makes a JSON objet of the <code>Js.Dict.t</code> <code>dict</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-array" id="value-array">array</a>: array(<a href="#type-t">t</a>) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>array_ a</code> makes a JSON array of the <code>Js.Json.t array</code> <code>a</code></p>
</div></div>

<div class='doc-item'><p>The functions below are specialized for specific array type which happened to be already JSON object in the BuckleScript runtime. Therefore they are more efficient (constant time rather than linear conversion).</p>
</div>

<div class='doc-item'><h4 class='item'>let <a href="#value-stringArray" id="value-stringArray">stringArray</a>: array(string) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>stringArray a</code> makes a JSON array of the <code>string array</code> <code>a</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-numberArray" id="value-numberArray">numberArray</a>: array(float) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>numberArray a</code> makes a JSON array of the <code>float array</code> <code>a</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-booleanArray" id="value-booleanArray">booleanArray</a>: array(<a href="Js.html#type-boolean" title="Js.boolean">boolean</a>) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>booleanArray</code> makes a JSON array of the <code>Js.boolean array</code> <code>a</code></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-objectArray" id="value-objectArray">objectArray</a>: array(<a href="Js_dict.html">Js_dict</a>.<a href="Js_dict.html#type-t">t</a>(<a href="#type-t">t</a>)) => <a href="#type-t">t</a></h4>

<div class='body '><p><code>objectArray a</code> makes a JSON array of the <code>JsDict.t array</code> <code>a</code></p>
</div></div>

<div class='doc-item'><h2 id="String-conversion">String conversion</h2></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-parseExn" id="value-parseExn">parseExn</a>: string => <a href="#type-t">t</a></h4>

<div class='body '><p><code>parseExn s</code> parses the string <code>s</code> into a JSON data structure</p>
<p><strong>Returns</strong> a JSON data structure</p>
<p>Raises: SyntaxError<p>if given string is not a valid JSON. Note <code>SyntaxError</code> is a JavaScript exception.</p>
<div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='38' id='block-38'><code>(* parse a simple JSON string *)

let json =
  try
    Js.Json.parseExn {| &quot;foo&quot; |}
  with
  | _ -&gt; failwith &quot;Error parsing JSON string&quot;
in
match Js.Json.classify json with
| Js.Json.JSONString value -&gt; Js.log value
| _ -&gt; failwith &quot;Expected a string&quot;</code></pre>
  
  <script type='docre-source' data-block-id="38">#open Js_json
(* parse a simple JSON string *)

let json =
  try
    Js.Json.parseExn {| "foo" |}
  with
  | _ -> failwith "Error parsing JSON string"
in
match Js.Json.classify json with
| Js.Json.JSONString value -> Js.log value
| _ -> failwith "Expected a string"</script>
  <div class='parse-error'>Parse Error:
File &quot;&quot;, line 9, characters 0-2:
Error: Syntax error</div>
</div><div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='38-alt' id='block-38-alt'><code>Unable to refmt code with a syntax error</code></pre>
  
  
  
</div><div class='code-block' data-block-syntax="ml">
  
  <pre class='code' data-block-id='37' id='block-37'><code>(* parse a complex JSON string *)

let getIds s =
  let json =
    try
      Js.Json.parseExn s
    with
    | _ -&gt; failwith &quot;Error parsing JSON string&quot;
  in
  match Js.Json.classify json with
  | Js.Json.JSONObject value -&gt;
    (* In this branch, compiler infer value : Js.Json.t Js.Dict.t *)
    begin match Js.Dict.get value &quot;ids&quot; with
    | Some ids -&gt;
      begin match Js.Json.classify ids with
      | Js.Json.JSONArray ids -&gt;
        (* In this branch compiler infer ids : Js.Json.t array *)
        ids
      | _ -&gt; failwith &quot;Expected an array&quot;
      end
    | None -&gt; failwith &quot;Expected an `ids` property&quot;
    end
  | _ -&gt; failwith &quot;Expected an object&quot;

(* prints `1, 2, 3` *)
let _ =
  Js.log \@\@ getIds {| { &quot;ids&quot; : [1, 2, 3 ] } |}</code></pre>
  
  <script type='docre-source' data-block-id="37">#open Js_json
(* parse a complex JSON string *)

let getIds s =
  let json =
    try
      Js.Json.parseExn s
    with
    | _ -> failwith "Error parsing JSON string"
  in
  match Js.Json.classify json with
  | Js.Json.JSONObject value ->
    (* In this branch, compiler infer value : Js.Json.t Js.Dict.t *)
    begin match Js.Dict.get value "ids" with
    | Some ids ->
      begin match Js.Json.classify ids with
      | Js.Json.JSONArray ids ->
        (* In this branch compiler infer ids : Js.Json.t array *)
        ids
      | _ -> failwith "Expected an array"
      end
    | None -> failwith "Expected an `ids` property"
    end
  | _ -> failwith "Expected an object"

(* prints `1, 2, 3` *)
let _ =
  Js.log \@\@ getIds {| { "ids" : [1, 2, 3 ] } |}</script>
  <div class='parse-error'>Parse Error:
File &quot;&quot;, line 28, characters 9-10:
Error: Illegal character (\\)</div>
</div><div class='code-block' data-block-syntax="re">
  
  <pre class='code' data-block-id='37-alt' id='block-37-alt'><code>Unable to refmt code with a syntax error</code></pre>
  
  
  
</div></p>
<p>See: <a href='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse'><p>MDN</p>
</a></p>
</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-stringify" id="value-stringify">stringify</a>: <a href="#type-t">t</a> => string</h4>

<div class='body '>failed to parse: File &quot;&quot;, line 2, characters 7-8:
unpaired &#39;}&#39; (end of markup)</div></div>

<div class='doc-item'><h4 class='item'>let <a href="#value-stringifyAny" id="value-stringifyAny">stringifyAny</a>: 'a => option(string)</h4>

<div class='body '>failed to parse: File &quot;&quot;, line 7, characters 103-103:
end of text is not allowed in &#39;{[...]}&#39; (code block)</div></div>
    </div>
    <div class='right-blank'></div>
    </div>
  